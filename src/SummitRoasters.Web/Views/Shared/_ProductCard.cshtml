@model ProductCardViewModel

<div class="group bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden hover:shadow-md transition-all duration-300" data-testid="product-card-@Model.Slug">
    <a asp-controller="Products" asp-action="Detail" asp-route-slug="@Model.Slug" class="block">
        <!-- Image -->
        <div class="relative aspect-square bg-cream-100 overflow-hidden">
            @if (!string.IsNullOrEmpty(Model.ImageUrl))
            {
                <img src="@Model.ImageUrl" alt="@Model.Name" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" loading="lazy" />
            }
            else
            {
                <div class="w-full h-full flex items-center justify-center">
                    <svg class="h-16 w-16 text-cream-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                    </svg>
                </div>
            }

            <!-- Category Badge -->
            <span class="absolute top-3 left-3 bg-white/90 backdrop-blur-sm text-brand-950 text-xs font-medium px-2.5 py-1 rounded-full" data-testid="product-card-category-@Model.Slug">
                @Model.Category
            </span>

            <!-- Roast Level Badge -->
            @if (Model.RoastLevel.HasValue)
            {
                <span class="absolute top-3 right-3 bg-brand-500/90 backdrop-blur-sm text-white text-xs font-medium px-2.5 py-1 rounded-full" data-testid="product-card-roast-@Model.Slug">
                    @Model.RoastLevel
                </span>
            }
        </div>

        <!-- Details -->
        <div class="p-4">
            <h3 class="font-display text-lg font-semibold text-brand-950 group-hover:text-brand-500 transition-colors line-clamp-1" data-testid="product-card-name-@Model.Slug">
                @Model.Name
            </h3>

            <!-- Price -->
            <div class="mt-2 flex items-center space-x-2" data-testid="product-card-price-@Model.Slug">
                <span class="text-lg font-bold text-brand-500">$@Model.Price.ToString("F2")</span>
                @if (Model.CompareAtPrice.HasValue && Model.CompareAtPrice > Model.Price)
                {
                    <span class="text-sm text-brand-400 line-through">$@Model.CompareAtPrice.Value.ToString("F2")</span>
                }
            </div>

            <!-- Rating -->
            @if (Model.AverageRating > 0)
            {
                <div class="mt-2 flex items-center space-x-1" data-testid="product-card-rating-@Model.Slug">
                    @await Html.PartialAsync("_RatingStars", Model.AverageRating)
                    <span class="text-xs text-brand-400 ml-1">(@Model.ReviewCount)</span>
                </div>
            }

            <!-- Stock Status -->
            <div class="mt-3" data-testid="product-card-stock-@Model.Slug">
                @if (Model.StockQuantity > 10)
                {
                    <span class="inline-flex items-center text-xs font-medium text-green-700">
                        <span class="w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"></span>
                        In Stock
                    </span>
                }
                else if (Model.StockQuantity > 0)
                {
                    <span class="inline-flex items-center text-xs font-medium text-amber-700">
                        <span class="w-1.5 h-1.5 bg-amber-500 rounded-full mr-1.5"></span>
                        Only @Model.StockQuantity left
                    </span>
                }
                else
                {
                    <span class="inline-flex items-center text-xs font-medium text-red-700">
                        <span class="w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"></span>
                        Out of Stock
                    </span>
                }
            </div>
        </div>
    </a>
</div>
