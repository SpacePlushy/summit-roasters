@model AdminOrderListViewModel
@{
    ViewData["Title"] = "Orders";
    Layout = "_AdminLayout";
}

<!-- Header -->
<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
    <p class="text-sm text-brand-400 mt-1" data-testid="admin-order-count">@Model.TotalCount orders</p>

    <!-- Status Filter -->
    <div class="mt-4 sm:mt-0 flex items-center space-x-2" data-testid="admin-order-status-filter">
        <span class="text-sm text-brand-400">Status:</span>
        <select id="order-status-filter" class="px-3 py-1.5 border border-cream-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-brand-500" data-testid="admin-order-status-select">
            <option value="">All</option>
            <option value="Pending">Pending</option>
            <option value="Processing">Processing</option>
            <option value="Shipped">Shipped</option>
            <option value="Delivered">Delivered</option>
            <option value="Cancelled">Cancelled</option>
        </select>
    </div>
</div>

<!-- Orders Table -->
<div class="bg-white rounded-xl border border-cream-200 overflow-hidden" data-testid="admin-order-table">
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead>
                <tr class="bg-cream-50">
                    <th class="px-6 py-3 text-left text-xs font-semibold text-brand-400 uppercase tracking-wider">Order</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-brand-400 uppercase tracking-wider">Customer</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-brand-400 uppercase tracking-wider">Date</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-brand-400 uppercase tracking-wider">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-brand-400 uppercase tracking-wider">Items</th>
                    <th class="px-6 py-3 text-right text-xs font-semibold text-brand-400 uppercase tracking-wider">Total</th>
                    <th class="px-6 py-3 text-right text-xs font-semibold text-brand-400 uppercase tracking-wider">Action</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-cream-200">
                @if (Model.Orders != null)
                {
                    @foreach (var order in Model.Orders)
                    {
                        <tr class="hover:bg-cream-50 transition-colors" data-testid="admin-order-row-@order.OrderNumber">
                            <td class="px-6 py-4">
                                <span class="text-sm font-mono font-bold text-brand-950" data-testid="admin-order-number-@order.OrderNumber">
                                    #@order.OrderNumber
                                </span>
                            </td>
                            <td class="px-6 py-4">
                                <div>
                                    <p class="text-sm font-medium text-brand-950" data-testid="admin-order-customer-@order.OrderNumber">@order.CustomerName</p>
                                    <p class="text-xs text-brand-400">@order.CustomerEmail</p>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm text-brand-600" data-testid="admin-order-date-@order.OrderNumber">@order.OrderDate.ToString("MMM d, yyyy")</span>
                            </td>
                            <td class="px-6 py-4" data-testid="admin-order-status-@order.OrderNumber">
                                @{
                                    var statusColors = order.Status switch
                                    {
                                        OrderStatus.Pending => "bg-yellow-50 text-yellow-700",
                                        OrderStatus.Processing => "bg-blue-50 text-blue-700",
                                        OrderStatus.Shipped => "bg-purple-50 text-purple-700",
                                        OrderStatus.Delivered => "bg-green-50 text-green-700",
                                        OrderStatus.Cancelled => "bg-red-50 text-red-700",
                                        _ => "bg-gray-50 text-gray-700"
                                    };
                                }
                                <span class="inline-flex items-center text-xs font-medium px-2.5 py-1 rounded-full @statusColors">
                                    @order.Status
                                </span>
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-sm text-brand-600" data-testid="admin-order-items-@order.OrderNumber">@order.ItemCount</span>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <span class="text-sm font-bold text-brand-950" data-testid="admin-order-total-@order.OrderNumber">$@order.Total.ToString("F2")</span>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <a asp-controller="Admin" asp-action="OrderDetail" asp-route-id="@order.Id"
                                   class="text-sm text-brand-500 hover:text-brand-600 font-medium transition-colors"
                                   data-testid="admin-order-view-@order.OrderNumber">
                                    View
                                </a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>

@if (Model.Pagination != null)
{
    @await Html.PartialAsync("_Pagination", Model.Pagination)
}
